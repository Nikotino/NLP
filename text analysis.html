Attention! Rpubs document link: http://rpubs.com/Nikotino/42194

<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>

<title></title>

<!-- Styles for R syntax highlighter -->
<style type="text/css">
   pre .operator,
   pre .paren {
     color: rgb(104, 118, 135)
   }

   pre .literal {
     color: #990073
   }

   pre .number {
     color: #099;
   }

   pre .comment {
     color: #998;
     font-style: italic
   }

   pre .keyword {
     color: #900;
     font-weight: bold
   }

   pre .identifier {
     color: rgb(0, 0, 0);
   }

   pre .string {
     color: #d14;
   }
</style>

<!-- R syntax highlighter -->
<script type="text/javascript">
var hljs=new function(){function m(p){return p.replace(/&/gm,"&amp;").replace(/</gm,"&lt;")}function f(r,q,p){return RegExp(q,"m"+(r.cI?"i":"")+(p?"g":""))}function b(r){for(var p=0;p<r.childNodes.length;p++){var q=r.childNodes[p];if(q.nodeName=="CODE"){return q}if(!(q.nodeType==3&&q.nodeValue.match(/\s+/))){break}}}function h(t,s){var p="";for(var r=0;r<t.childNodes.length;r++){if(t.childNodes[r].nodeType==3){var q=t.childNodes[r].nodeValue;if(s){q=q.replace(/\n/g,"")}p+=q}else{if(t.childNodes[r].nodeName=="BR"){p+="\n"}else{p+=h(t.childNodes[r])}}}if(/MSIE [678]/.test(navigator.userAgent)){p=p.replace(/\r/g,"\n")}return p}function a(s){var r=s.className.split(/\s+/);r=r.concat(s.parentNode.className.split(/\s+/));for(var q=0;q<r.length;q++){var p=r[q].replace(/^language-/,"");if(e[p]){return p}}}function c(q){var p=[];(function(s,t){for(var r=0;r<s.childNodes.length;r++){if(s.childNodes[r].nodeType==3){t+=s.childNodes[r].nodeValue.length}else{if(s.childNodes[r].nodeName=="BR"){t+=1}else{if(s.childNodes[r].nodeType==1){p.push({event:"start",offset:t,node:s.childNodes[r]});t=arguments.callee(s.childNodes[r],t);p.push({event:"stop",offset:t,node:s.childNodes[r]})}}}}return t})(q,0);return p}function k(y,w,x){var q=0;var z="";var s=[];function u(){if(y.length&&w.length){if(y[0].offset!=w[0].offset){return(y[0].offset<w[0].offset)?y:w}else{return w[0].event=="start"?y:w}}else{return y.length?y:w}}function t(D){var A="<"+D.nodeName.toLowerCase();for(var B=0;B<D.attributes.length;B++){var C=D.attributes[B];A+=" "+C.nodeName.toLowerCase();if(C.value!==undefined&&C.value!==false&&C.value!==null){A+='="'+m(C.value)+'"'}}return A+">"}while(y.length||w.length){var v=u().splice(0,1)[0];z+=m(x.substr(q,v.offset-q));q=v.offset;if(v.event=="start"){z+=t(v.node);s.push(v.node)}else{if(v.event=="stop"){var p,r=s.length;do{r--;p=s[r];z+=("</"+p.nodeName.toLowerCase()+">")}while(p!=v.node);s.splice(r,1);while(r<s.length){z+=t(s[r]);r++}}}}return z+m(x.substr(q))}function j(){function q(x,y,v){if(x.compiled){return}var u;var s=[];if(x.k){x.lR=f(y,x.l||hljs.IR,true);for(var w in x.k){if(!x.k.hasOwnProperty(w)){continue}if(x.k[w] instanceof Object){u=x.k[w]}else{u=x.k;w="keyword"}for(var r in u){if(!u.hasOwnProperty(r)){continue}x.k[r]=[w,u[r]];s.push(r)}}}if(!v){if(x.bWK){x.b="\\b("+s.join("|")+")\\s"}x.bR=f(y,x.b?x.b:"\\B|\\b");if(!x.e&&!x.eW){x.e="\\B|\\b"}if(x.e){x.eR=f(y,x.e)}}if(x.i){x.iR=f(y,x.i)}if(x.r===undefined){x.r=1}if(!x.c){x.c=[]}x.compiled=true;for(var t=0;t<x.c.length;t++){if(x.c[t]=="self"){x.c[t]=x}q(x.c[t],y,false)}if(x.starts){q(x.starts,y,false)}}for(var p in e){if(!e.hasOwnProperty(p)){continue}q(e[p].dM,e[p],true)}}function d(B,C){if(!j.called){j();j.called=true}function q(r,M){for(var L=0;L<M.c.length;L++){if((M.c[L].bR.exec(r)||[null])[0]==r){return M.c[L]}}}function v(L,r){if(D[L].e&&D[L].eR.test(r)){return 1}if(D[L].eW){var M=v(L-1,r);return M?M+1:0}return 0}function w(r,L){return L.i&&L.iR.test(r)}function K(N,O){var M=[];for(var L=0;L<N.c.length;L++){M.push(N.c[L].b)}var r=D.length-1;do{if(D[r].e){M.push(D[r].e)}r--}while(D[r+1].eW);if(N.i){M.push(N.i)}return f(O,M.join("|"),true)}function p(M,L){var N=D[D.length-1];if(!N.t){N.t=K(N,E)}N.t.lastIndex=L;var r=N.t.exec(M);return r?[M.substr(L,r.index-L),r[0],false]:[M.substr(L),"",true]}function z(N,r){var L=E.cI?r[0].toLowerCase():r[0];var M=N.k[L];if(M&&M instanceof Array){return M}return false}function F(L,P){L=m(L);if(!P.k){return L}var r="";var O=0;P.lR.lastIndex=0;var M=P.lR.exec(L);while(M){r+=L.substr(O,M.index-O);var N=z(P,M);if(N){x+=N[1];r+='<span class="'+N[0]+'">'+M[0]+"</span>"}else{r+=M[0]}O=P.lR.lastIndex;M=P.lR.exec(L)}return r+L.substr(O,L.length-O)}function J(L,M){if(M.sL&&e[M.sL]){var r=d(M.sL,L);x+=r.keyword_count;return r.value}else{return F(L,M)}}function I(M,r){var L=M.cN?'<span class="'+M.cN+'">':"";if(M.rB){y+=L;M.buffer=""}else{if(M.eB){y+=m(r)+L;M.buffer=""}else{y+=L;M.buffer=r}}D.push(M);A+=M.r}function G(N,M,Q){var R=D[D.length-1];if(Q){y+=J(R.buffer+N,R);return false}var P=q(M,R);if(P){y+=J(R.buffer+N,R);I(P,M);return P.rB}var L=v(D.length-1,M);if(L){var O=R.cN?"</span>":"";if(R.rE){y+=J(R.buffer+N,R)+O}else{if(R.eE){y+=J(R.buffer+N,R)+O+m(M)}else{y+=J(R.buffer+N+M,R)+O}}while(L>1){O=D[D.length-2].cN?"</span>":"";y+=O;L--;D.length--}var r=D[D.length-1];D.length--;D[D.length-1].buffer="";if(r.starts){I(r.starts,"")}return R.rE}if(w(M,R)){throw"Illegal"}}var E=e[B];var D=[E.dM];var A=0;var x=0;var y="";try{var s,u=0;E.dM.buffer="";do{s=p(C,u);var t=G(s[0],s[1],s[2]);u+=s[0].length;if(!t){u+=s[1].length}}while(!s[2]);if(D.length>1){throw"Illegal"}return{r:A,keyword_count:x,value:y}}catch(H){if(H=="Illegal"){return{r:0,keyword_count:0,value:m(C)}}else{throw H}}}function g(t){var p={keyword_count:0,r:0,value:m(t)};var r=p;for(var q in e){if(!e.hasOwnProperty(q)){continue}var s=d(q,t);s.language=q;if(s.keyword_count+s.r>r.keyword_count+r.r){r=s}if(s.keyword_count+s.r>p.keyword_count+p.r){r=p;p=s}}if(r.language){p.second_best=r}return p}function i(r,q,p){if(q){r=r.replace(/^((<[^>]+>|\t)+)/gm,function(t,w,v,u){return w.replace(/\t/g,q)})}if(p){r=r.replace(/\n/g,"<br>")}return r}function n(t,w,r){var x=h(t,r);var v=a(t);var y,s;if(v){y=d(v,x)}else{return}var q=c(t);if(q.length){s=document.createElement("pre");s.innerHTML=y.value;y.value=k(q,c(s),x)}y.value=i(y.value,w,r);var u=t.className;if(!u.match("(\\s|^)(language-)?"+v+"(\\s|$)")){u=u?(u+" "+v):v}if(/MSIE [678]/.test(navigator.userAgent)&&t.tagName=="CODE"&&t.parentNode.tagName=="PRE"){s=t.parentNode;var p=document.createElement("div");p.innerHTML="<pre><code>"+y.value+"</code></pre>";t=p.firstChild.firstChild;p.firstChild.cN=s.cN;s.parentNode.replaceChild(p.firstChild,s)}else{t.innerHTML=y.value}t.className=u;t.result={language:v,kw:y.keyword_count,re:y.r};if(y.second_best){t.second_best={language:y.second_best.language,kw:y.second_best.keyword_count,re:y.second_best.r}}}function o(){if(o.called){return}o.called=true;var r=document.getElementsByTagName("pre");for(var p=0;p<r.length;p++){var q=b(r[p]);if(q){n(q,hljs.tabReplace)}}}function l(){if(window.addEventListener){window.addEventListener("DOMContentLoaded",o,false);window.addEventListener("load",o,false)}else{if(window.attachEvent){window.attachEvent("onload",o)}else{window.onload=o}}}var e={};this.LANGUAGES=e;this.highlight=d;this.highlightAuto=g;this.fixMarkup=i;this.highlightBlock=n;this.initHighlighting=o;this.initHighlightingOnLoad=l;this.IR="[a-zA-Z][a-zA-Z0-9_]*";this.UIR="[a-zA-Z_][a-zA-Z0-9_]*";this.NR="\\b\\d+(\\.\\d+)?";this.CNR="\\b(0[xX][a-fA-F0-9]+|(\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)";this.BNR="\\b(0b[01]+)";this.RSR="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|\\.|-|-=|/|/=|:|;|<|<<|<<=|<=|=|==|===|>|>=|>>|>>=|>>>|>>>=|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~";this.ER="(?![\\s\\S])";this.BE={b:"\\\\.",r:0};this.ASM={cN:"string",b:"'",e:"'",i:"\\n",c:[this.BE],r:0};this.QSM={cN:"string",b:'"',e:'"',i:"\\n",c:[this.BE],r:0};this.CLCM={cN:"comment",b:"//",e:"$"};this.CBLCLM={cN:"comment",b:"/\\*",e:"\\*/"};this.HCM={cN:"comment",b:"#",e:"$"};this.NM={cN:"number",b:this.NR,r:0};this.CNM={cN:"number",b:this.CNR,r:0};this.BNM={cN:"number",b:this.BNR,r:0};this.inherit=function(r,s){var p={};for(var q in r){p[q]=r[q]}if(s){for(var q in s){p[q]=s[q]}}return p}}();hljs.LANGUAGES.cpp=function(){var a={keyword:{"false":1,"int":1,"float":1,"while":1,"private":1,"char":1,"catch":1,"export":1,virtual:1,operator:2,sizeof:2,dynamic_cast:2,typedef:2,const_cast:2,"const":1,struct:1,"for":1,static_cast:2,union:1,namespace:1,unsigned:1,"long":1,"throw":1,"volatile":2,"static":1,"protected":1,bool:1,template:1,mutable:1,"if":1,"public":1,friend:2,"do":1,"return":1,"goto":1,auto:1,"void":2,"enum":1,"else":1,"break":1,"new":1,extern:1,using:1,"true":1,"class":1,asm:1,"case":1,typeid:1,"short":1,reinterpret_cast:2,"default":1,"double":1,register:1,explicit:1,signed:1,typename:1,"try":1,"this":1,"switch":1,"continue":1,wchar_t:1,inline:1,"delete":1,alignof:1,char16_t:1,char32_t:1,constexpr:1,decltype:1,noexcept:1,nullptr:1,static_assert:1,thread_local:1,restrict:1,_Bool:1,complex:1},built_in:{std:1,string:1,cin:1,cout:1,cerr:1,clog:1,stringstream:1,istringstream:1,ostringstream:1,auto_ptr:1,deque:1,list:1,queue:1,stack:1,vector:1,map:1,set:1,bitset:1,multiset:1,multimap:1,unordered_set:1,unordered_map:1,unordered_multiset:1,unordered_multimap:1,array:1,shared_ptr:1}};return{dM:{k:a,i:"</",c:[hljs.CLCM,hljs.CBLCLM,hljs.QSM,{cN:"string",b:"'\\\\?.",e:"'",i:"."},{cN:"number",b:"\\b(\\d+(\\.\\d*)?|\\.\\d+)(u|U|l|L|ul|UL|f|F)"},hljs.CNM,{cN:"preprocessor",b:"#",e:"$"},{cN:"stl_container",b:"\\b(deque|list|queue|stack|vector|map|set|bitset|multiset|multimap|unordered_map|unordered_set|unordered_multiset|unordered_multimap|array)\\s*<",e:">",k:a,r:10,c:["self"]}]}}}();hljs.LANGUAGES.r={dM:{c:[hljs.HCM,{cN:"number",b:"\\b0[xX][0-9a-fA-F]+[Li]?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+(?:[eE][+\\-]?\\d*)?L\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+\\.(?!\\d)(?:i\\b)?",e:hljs.IMMEDIATE_RE,r:1},{cN:"number",b:"\\b\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\.\\d+(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"keyword",b:"(?:tryCatch|library|setGeneric|setGroupGeneric)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\.",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\d+(?![\\w.])",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\b(?:function)",e:hljs.IMMEDIATE_RE,r:2},{cN:"keyword",b:"(?:if|in|break|next|repeat|else|for|return|switch|while|try|stop|warning|require|attach|detach|source|setMethod|setClass)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"literal",b:"(?:NA|NA_integer_|NA_real_|NA_character_|NA_complex_)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"literal",b:"(?:NULL|TRUE|FALSE|T|F|Inf|NaN)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"identifier",b:"[a-zA-Z.][a-zA-Z0-9._]*\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"<\\-(?!\\s*\\d)",e:hljs.IMMEDIATE_RE,r:2},{cN:"operator",b:"\\->|<\\-",e:hljs.IMMEDIATE_RE,r:1},{cN:"operator",b:"%%|~",e:hljs.IMMEDIATE_RE},{cN:"operator",b:">=|<=|==|!=|\\|\\||&&|=|\\+|\\-|\\*|/|\\^|>|<|!|&|\\||\\$|:",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"%",e:"%",i:"\\n",r:1},{cN:"identifier",b:"`",e:"`",r:0},{cN:"string",b:'"',e:'"',c:[hljs.BE],r:0},{cN:"string",b:"'",e:"'",c:[hljs.BE],r:0},{cN:"paren",b:"[[({\\])}]",e:hljs.IMMEDIATE_RE,r:0}]}};
hljs.initHighlightingOnLoad();
</script>

<!-- MathJax scripts -->
<script type="text/javascript" src="https://c328740.ssl.cf1.rackcdn.com/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


<style type="text/css">
body, td {
   font-family: sans-serif;
   background-color: white;
   font-size: 13px;
}

body {
  max-width: 800px;
  margin: auto;
  padding: 1em;
  line-height: 20px;
}

tt, code, pre {
   font-family: 'DejaVu Sans Mono', 'Droid Sans Mono', 'Lucida Console', Consolas, Monaco, monospace;
}

h1 {
   font-size:2.2em;
}

h2 {
   font-size:1.8em;
}

h3 {
   font-size:1.4em;
}

h4 {
   font-size:1.0em;
}

h5 {
   font-size:0.9em;
}

h6 {
   font-size:0.8em;
}

a:visited {
   color: rgb(50%, 0%, 50%);
}

pre, img {
  max-width: 100%;
}

pre code {
   display: block; padding: 0.5em;
}

code {
  font-size: 92%;
  border: 1px solid #ccc;
}

code[class] {
  background-color: #F8F8F8;
}

table, td, th {
  border: none;
}

blockquote {
   color:#666666;
   margin:0;
   padding-left: 1em;
   border-left: 0.5em #EEE solid;
}

hr {
   height: 0px;
   border-bottom: none;
   border-top-width: thin;
   border-top-style: dotted;
   border-top-color: #999999;
}

@media print {
   * {
      background: transparent !important;
      color: black !important;
      filter:none !important;
      -ms-filter: none !important;
   }

   body {
      font-size:12pt;
      max-width:100%;
   }

   a, a:visited {
      text-decoration: underline;
   }

   hr {
      visibility: hidden;
      page-break-before: always;
   }

   pre, blockquote {
      padding-right: 1em;
      page-break-inside: avoid;
   }

   tr, img {
      page-break-inside: avoid;
   }

   img {
      max-width: 100% !important;
   }

   @page :left {
      margin: 15mm 20mm 15mm 10mm;
   }

   @page :right {
      margin: 15mm 10mm 15mm 20mm;
   }

   p, h2, h3 {
      orphans: 3; widows: 3;
   }

   h2, h3 {
      page-break-after: avoid;
   }
}
</style>



</head>

<body>
<ol>
<li>Read the file. Since I want to make a few comparisons between laguages I also add English blogs file. 
All further analysis will be done based on blogs files, for news and twitter files operations would be similar.</li>
</ol>

<pre><code class="r">setwd(&quot;C:/Users/Veronika/Documents/R files/Natural Language Processing/Coursera-SwiftKey&quot;)
blogs&lt;-readLines(&quot;ru_RU/ru_RU.blogs.txt&quot;,encoding=&#39;UTF-8&#39;)
news&lt;-readLines(&quot;ru_RU/ru_RU.news.txt&quot;,encoding=&#39;UTF-8&#39;)
twitter&lt;-readLines(&quot;ru_RU/ru_RU.twitter.txt&quot;,encoding=&#39;UTF-8&#39;)
</code></pre>

<pre><code>## Warning: line 191902 appears to contain an embedded nul
## Warning: line 309777 appears to contain an embedded nul
</code></pre>

<pre><code class="r">blogs_en&lt;-readLines(&quot;en_US/en_US.blogs.txt&quot;)
</code></pre>

<ol>
<li>Create files samples for quick exploration and load profanity libraries</li>
</ol>

<pre><code class="r">sampleblog&lt;-sample(blogs,5000)

sampleblog&lt;-gsub(&quot;[a-z]&quot;,&quot;&quot;,sampleblog) #exclude latin words from Russian text 
sampleblog&lt;-paste(sampleblog,collapse=&quot; &quot;) 

sampleblog_en&lt;- sample(blogs_en, 5000)
sampleblog_en&lt;-paste(sampleblog_en,collapse=&quot; &quot;) 

badwords&lt;-readLines(&quot;https://dl.dropboxusercontent.com/u/156838/Spisok/mat-spisok_lt.txt&quot;,encoding=&#39;UTF-8&#39;)
badwords_en&lt;-readLines(&quot;http://www.cs.cmu.edu/~biglou/resources/bad-words.txt&quot;)
</code></pre>

<ol>
<li>Tokenize the texts, create words summary and n-grams
In tokenization I do the following cleaning:</li>
<li>for unigrams remove words of less than 4 characters as non-informative of the text. For bigrams and trigrams I keep all words, otherwise many expressions would be damaged</li>
<li>remove profanity words</li>
<li>remove sparse words</li>
<li>change all words to lower characters, so that words in the beggining of the sentences wouldnt count as separate words </li>
</ol>

<pre><code class="r">library(&quot;tm&quot;)
</code></pre>

<pre><code>## Warning: package &#39;tm&#39; was built under R version 3.1.2
</code></pre>

<pre><code>## Loading required package: NLP
</code></pre>

<pre><code>## Warning: package &#39;NLP&#39; was built under R version 3.1.2
</code></pre>

<pre><code class="r">library(&quot;RWeka&quot;)
</code></pre>

<pre><code>## Warning: package &#39;RWeka&#39; was built under R version 3.1.2
</code></pre>

<pre><code class="r">library(&quot;reshape2&quot;)
</code></pre>

<pre><code>## Warning: package &#39;reshape2&#39; was built under R version 3.1.1
</code></pre>

<pre><code class="r">document&lt;-Corpus(VectorSource(sampleblog))
document_en&lt;-Corpus(VectorSource(sampleblog_en))

UnigramTokenizer &lt;- function(x) NGramTokenizer(x, Weka_control(min = 1, max = 1))
BigramTokenizer &lt;- function(x) NGramTokenizer(x, Weka_control(min = 2, max = 2))
TrigramTokenizer &lt;- function(x) NGramTokenizer(x, Weka_control(min = 3, max = 3))

unifreq &lt;- TermDocumentMatrix(document, control = list(tokenize = UnigramTokenizer, wordLengths=c(4,Inf),removeSparseTerms=TRUE, stopwords=badwords,tolower = TRUE))                 
bifreq &lt;- TermDocumentMatrix(document, control = list(tokenize = BigramTokenizer, removeSparseTerms=TRUE, stopwords=badwords,tolower = TRUE))                 
trifreq &lt;- TermDocumentMatrix(document, control = list(tokenize = TrigramTokenizer, removeSparseTerms=TRUE, stopwords=badwords,tolower = TRUE))

unifreq&lt;-as.matrix(unifreq)
unifreq = melt(unifreq, value.name = &quot;count&quot;)
unifreq&lt;-aggregate(count~Terms,data=unifreq,FUN=&quot;sum&quot;)
unifreq&lt;-unifreq[order(unifreq$count,decreasing=TRUE),]

bifreq&lt;-as.matrix(bifreq)
bifreq = melt(bifreq, value.name = &quot;count&quot;)
bifreq&lt;-aggregate(count~Terms,data=bifreq,FUN=&quot;sum&quot;)
bifreq&lt;-bifreq[order(bifreq$count,decreasing=TRUE),]

trifreq&lt;-as.matrix(trifreq)
trifreq = melt(trifreq, value.name = &quot;count&quot;)
trifreq&lt;-aggregate(count~Terms,data=trifreq,FUN=&quot;sum&quot;)
trifreq&lt;-trifreq[order(trifreq$count,decreasing=TRUE),]

head(unifreq,10)
</code></pre>

<pre><code>##        Terms count
## 15006   меня   357
## 20248  очень   356
## 32368 только   320
## 8617    если   316
## 3458    было   264
## 8627    есть   256
## 35534  чтобы   231
## 15555  можно   230
## 12263  когда   225
## 25741 просто   217
</code></pre>

<pre><code class="r">head(bifreq,10)
</code></pre>

<pre><code>##                 Terms count
## 102415         у меня   151
## 35568            и не   124
## 102424          у нас    98
## 34375             и в    94
## 100509         то что    94
## 70847  пермского края    88
## 13683          в этом    77
## 77162      потому что    74
## 98381         так что    74
## 101116        том что    71
</code></pre>

<pre><code class="r">head(trifreq,10)
</code></pre>

<pre><code>##                     Terms count
## 76828           о том что    41
## 45229               и т д    28
## 32208          до сих пор    26
## 66787 на следующей неделе    26
## 17100           в том что    24
## 16586           в связи с    21
## 17099         в том числе    20
## 16771    в соответствии с    19
## 17521         в этом году    19
## 31706      для того чтобы    16
</code></pre>

<ol>
<li>A few comparison between Russian and English</li>
</ol>

<p>I do the comparison to check a few hypothesis I have regarding Russian and English:</p>

<ul>
<li>Russian words, on average, are longer than English ones even if we remove articles</li>
<li>Russian language is more diverse, ie you would need more words to cover the majority of words in text</li>
</ul>

<p>##Compare average words length</p>

<pre><code class="r">#Add summary of English words
unifreq_en &lt;- TermDocumentMatrix(document_en, control = list(tokenize = UnigramTokenizer, wordLengths=c(4,Inf), removeSparseTerms=TRUE, stopwords=badwords,tolower = TRUE))                 
unifreq_en&lt;-as.matrix(unifreq_en)
unifreq_en = melt(unifreq_en, value.name = &quot;count&quot;)
unifreq_en&lt;-aggregate(count~Terms,data=unifreq_en,FUN=&quot;sum&quot;)
unifreq_en&lt;-unifreq_en[order(unifreq_en$count,decreasing=TRUE),]
head(unifreq_en,10)
</code></pre>

<pre><code>##       Terms count
## 18536  that  2571
## 20443  with  1632
## 18632  this  1405
## 8562   have  1250
## 7595   from   840
## 18595  they   755
## 480   about   641
## 20261  what   615
## 20273  when   614
## 20369  will   603
</code></pre>

<pre><code class="r">#Average words length
unifreq$nchar&lt;-nchar(as.character(unifreq$Terms))
rus_nchar&lt;-aggregate(count~nchar,data=unifreq,FUN=&quot;sum&quot;)
rus_nchar$count&lt;-rus_nchar$count/sum(rus_nchar$count)
rus_nchar$language&lt;-&quot;rus&quot;

unifreq_en$nchar&lt;-nchar(as.character(unifreq_en$Terms))
en_nchar&lt;-aggregate(count~nchar,data=unifreq_en,FUN=&quot;sum&quot;)
en_nchar$count&lt;-en_nchar$count/sum(en_nchar$count)
en_nchar$language&lt;-&quot;en&quot;
nchar&lt;-rbind(rus_nchar,en_nchar)

library(&quot;ggplot2&quot;)
</code></pre>

<pre><code>## Warning: package &#39;ggplot2&#39; was built under R version 3.1.1
</code></pre>

<pre><code>## 
## Attaching package: &#39;ggplot2&#39;
## 
## The following object is masked from &#39;package:NLP&#39;:
## 
##     annotate
</code></pre>

<pre><code class="r">ggplot(nchar, aes(x=nchar, y=count, colour=language)) + geom_line()
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-4"/> 
The plot demonstrates my hypothesis is true.  I can explain the difference by different morfology of languages, ie where in English most words have only root and ending, in Russian majority of words are created through addition of preposition and suffix to the root.</p>

<p>#What&#39;s % of words constitutes different % of words used</p>

<pre><code class="r">sum&lt;-vector()
sum_en&lt;-vector()
rus&lt;-vector()
eng&lt;-vector()

for (i in 1:nrow(unifreq)){
  sum[i]&lt;-sum(unifreq$count[c(1:i)])}

for (i in 1:nrow(unifreq_en)){
  sum_en[i]&lt;-sum(unifreq_en$count[c(1:i)])}

for (i in 1:10){
  rus[i]&lt;-which(sum&gt;=sum(unifreq[,2])*i/10)[1]/nrow(unifreq)
  eng[i]&lt;-which(sum_en&gt;=sum(unifreq_en[,2])*i/10)[1]/nrow(unifreq_en)
}

shares &lt;- melt(cbind(rus,eng), id=row.names)
colnames(shares)&lt;-c(&quot;share&quot;,&quot;language&quot;,&quot;value&quot;)
shares$share&lt;-shares$share/10

qplot(data=shares,share/10,value,group=language,colour=language,xlab=&quot;share of words covered&quot;,ylab=&quot;top words as share of total words&quot;)+geom_line()
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-5"/> 
The plot confirms my hypothesis, as we see in Russia much higher share of words would be needed to cover the same % of text. Major explanations would be:</p>

<ul>
<li>in Russian adjectives ending change upon gender and number, while in English it would be the same word in all cases</li>
<li>many verbs in English change meaning through additions while verb stays the same, while in Russian through preposition,thus, creating different words (e.g. fall+(about/into/apart/away/back/in) would be all different words in Russian).</li>
</ul>

<p>##How do you evaluate how many of the words come from foreign languages?</p>

<p>Ideally you would need to load the dictionary of foreign words and do the comparison.  However, for the sake of memory I would use a few simple features of Russian words which come from foreign language:</p>

<ul>
<li>words starting with letters &ldquo;а&rdquo;,&ldquo;ф&rdquo;,&ldquo;ге&rdquo;,&ldquo;ке&rdquo;,&ldquo;дж&rdquo; (<sup>а|<sup>ф|<sup>ге|<sup>ке|<sup>дж)</sup></sup></sup></sup></sup></li>
<li>words containing syllables &ldquo;кю|пю|бю|вю|кю|мю|ау|ао|ео|еа|еи|ион&rdquo; or letter &ldquo;э&rdquo; (exept &ldquo;этот&rdquo;/this)</li>
<li>words ending with нг|изм</li>
<li>words with double consonants except for double &ldquo;н&rdquo; (common in adjectives) and double &ldquo;c&rdquo; caused by preposition (&ldquo;рас|вос|под&rdquo;)</li>
</ul>

<pre><code class="r">foreign&lt;-unifreq[(grep(&quot;^а|^ф|^ге|^ке|^дж|кю|пю|бю|вю|кю|мю|ау|ао|ео|еа|еи|э[^это][^эти]|нг$|изм$|ион&quot;,unifreq$Terms)),]
consonant&lt;-strsplit(&quot;бвгджзйклмнпрстфхцчшщ&quot;,split=&quot;&quot;)[[1]]
double&lt;-unifreq[grep(paste(paste(consonant[-11],&quot;+{2}&quot;,sep=&quot;&quot;),collapse=&quot;|&quot;),unifreq$Terms),]
double&lt;-double[-grep(&quot;^рас|^вос|^под&quot;,double$Terms),]
foreign&lt;-rbind(foreign,double)
foreign&lt;-foreign[order(foreign$Terms),]
foreign&lt;-foreign[unique(foreign$Terms),]
head(foreign$Terms,10)
</code></pre>

<pre><code>##  [1] “ацк-бюджетный      “электронное        «планово-бюджетный»
##  [4] «тиффани»           61-миллиардного     а50-17638/2011     
##  [7] аааааааа            абсолютным          авианосных         
## [10] авианосцев         
## 36536 Levels: -«давно -132 -20% -2011 -4031 -№33 -аттестовать -бам ... ящику
</code></pre>

<p>I have done review of &ldquo;foreign&rdquo; dataframe to make sure that the majority of words there are words borrowed from foreign language but I do not provide the full list of &gt;2Ks words here.</p>

<p>Overall, I get the estimation of foreign words share of ~9%.  This is in line with general estimation by linguists that the share foreign words in Russian is within 20%.</p>

<pre><code class="r">nrow(foreign)/nrow(unifreq)
</code></pre>

<pre><code>## [1] 0.08931
</code></pre>

<p>library(knitr)
library(markdown)
knit2html(&ldquo;text analysis Rmd&rdquo;)</p>

</body>

</html>
